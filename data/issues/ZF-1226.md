---
layout: issue
title: "Zend_Db_Adapter_Abstract::insert() does not work properly in Oracle 9i"
id: ZF-1226
---

ZF-1226: Zend\_Db\_Adapter\_Abstract::insert() does not work properly in Oracle 9i
----------------------------------------------------------------------------------

 Issue Type: Bug Created: 2007-04-09T10:44:41.000+0000 Last Updated: 2007-07-05T14:44:03.000+0000 Status: Resolved Fix version(s): - 1.0.0 RC1 (28/May/07)
 
 Reporter:  Ruben Dorta (rdorta)  Assignee:  Antony Dovgal (tony2001)  Tags: - Zend\_Db\_Adapter\_Oracle
 
 Related issues: 
 Attachments: 
### Description

Since 0.9.0 DB->insert() don't work properly in Oracle 9i, for example:

 
    <pre class="highlight">
    $db->insert("TABLE", $array);


with $array equals to:

 
    <pre class="highlight">
    Array
    (
        [NAME] => Testing
        [SHORT_NAME] => tst
        [DESCRIPTION] => 123456
        [USER_ID] => 968
    )


In 0.8.0 version works properly. In 0.9.x the same procedure shows me this error:

 
    <pre class="highlight">
    Warning: oci_bind_by_name() [function.oci-bind-by-name]: ORA-01036: 
    illegal variable name/number in /usr/local/www/lib/ZendFramework-0.9.1-Beta/library/Zend/Db/Statement/Oracle.php on line 162


I checked the source code, and I found that the function $db->insert() in Zend/Db/Adapter/Abstract.php is not working as before. The generated sql queries are different and I cannot use $db->insert() in Oracle 9i.

For the example before, in 0.8.0 the generated query and the internal array are:

 
    <pre class="highlight">
    INSERT INTO TABLE (
        NAME, SHORT_NAME, DESCRIPTION, USER_ID
    ) VALUES (
        :NAME, :SHORT_NAME, :DESCRIPTION, :USER_ID
    )


 
    <pre class="highlight">
    Array
    (
        [NAME] => Testing
        [SHORT_NAME] => tst
        [DESCRIPTION] => 123456
        [USER_ID] => 968
    )


So, when the Oracle function calls oci\_bind\_by\_name the function works and the insert function works OK.

But in 0.9.x this is the result:

 
    <pre class="highlight">
    INSERT INTO "TABLE" (
        "NAME", "SHORT_NAME", "DESCRIPTION", "USER_ID"
    ) VALUES (
        ?, ?, ?, ?
    )


 
    <pre class="highlight">
    Array
    (
        [1] => Testing
        [2] => tst
        [3] => 123456
        [4] => 968
    )


As far I can see in this case, since 0.9.0 the insert query (which is automatically generated by the function db->insert in Zend/Db/Adapter/Abstract) changed so I cannot use this function in Oracle.

I was trying to fix the execute function in Zend/Db/Statement/Oracle.php but it appears like an error in Zend/Db/Adapter/Abstract and could affect other database code like Mysql, PDO, etc.

 

 

### Comments

Posted by Bill Karwin (bkarwin) on 2007-04-09T12:57:16.000+0000

Reformat summary, description.

 

 

Posted by Bill Karwin (bkarwin) on 2007-04-24T00:49:25.000+0000

Assigning to Antony.

 

 

Posted by Antony Dovgal (tony2001) on 2007-05-07T06:23:43.000+0000

Should be fixed in SVN, please try and confirm.

 

 

Posted by Bill Karwin (bkarwin) on 2007-05-07T11:58:32.000+0000

Set fix version to 1.0.0RC1.

 

 