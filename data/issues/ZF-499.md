---
layout: issue
title: "Oracle: lastInsertId throws an exception"
id: ZF-499
---

ZF-499: Oracle: lastInsertId throws an exception
------------------------------------------------

 Issue Type: Bug Created: 2006-11-06T09:45:48.000+0000 Last Updated: 2007-07-05T14:43:25.000+0000 Status: Resolved Fix version(s): - 1.0.0 RC1 (28/May/07)
 
 Reporter:  Svetlin Tsvetanov (svetbg)  Assignee:  Bill Karwin (bkarwin)  Tags: - Zend\_Db
 
 Related issues: 
 Attachments: 
### Description

Add case Zend\_Db::FETCH\_COLUMN: $flags |= OCI\_NUM; $flags |= OCI\_ASSOC; break; in fetchAll function in Db/Statement/Oracle.php

 

 

### Comments

Posted by Bill Karwin (bkarwin) on 2006-11-08T12:12:18.000+0000

Assigning to me, categorizing as Zend\_Db issue.

 

 

Posted by Bill Karwin (bkarwin) on 2006-11-13T15:22:37.000+0000

Changing fix version to 0.8.0.

 

 

Posted by Bill Karwin (bkarwin) on 2007-05-07T13:15:54.000+0000

This issue is resolved by new usage for Oracle with respect to sequences. You should not use lastInsertId() for Oracle, unless you pass arguments to resolve the sequence name:

 
    <pre class="highlight">
    $db->lastInsertId('foo');


Returns the last id generated by sequence named foo\_seq.

 
    <pre class="highlight">
    $db->lastInsertId('foo', 'id');


Returns the last id generated by sequence named foo\_id\_seq.

You can also run lastSequenceId() directly:

 
    <pre class="highlight">
    $db->lastSequenceId('foo_id_seq');


This returns the last id generated by the named sequence. Use this if your sequence name does not conform to the naming convention used by lastInsertId().

 

 